#!/bin/bash

# pip install watchdog
# sudo sysctl fs.inotify.max_user_watches=16384
WATCHMEDO=/home/humitos/.pyenv/versions/rtfd/bin/watchmedo
CELERY=/home/humitos/.pyenv/versions/rtfd/bin/celery

cd /home/humitos/rtfd/code/readthedocs.org

$WATCHMEDO auto-restart \
  --patterns="*.py" \
  --ignore-patterns="*.#*.py;./user_builds/*" \
  --ignore-directories \
  --recursive \
  --signal=9 \
  -- \
  $CELERY -A readthedocs worker -Q default,celery,web,builder -l DEBUG -c 2
